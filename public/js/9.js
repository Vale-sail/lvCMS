webpackJsonp([9],{257:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:["power"],mounted:function(){this.init()},filters:{stateTag:function(t){return 0==t?"primary":1==t?"success":2==t?"warning":3==t?"danger":void 0},stateToWord:function(t){return 0==t?"置顶":1==t?"正常":2==t?"草稿":3==t?"回收站":void 0}},data:function(){return{stateOptionsVisible:!1,formLabelWidth:"120px",batchChangeState:"",selectItem:[],actionOptions:[{value:1,label:"批量删除"},{value:2,label:"批量改变状态"}],action:"",stateOptions:[{value:0,label:"置顶"},{value:1,label:"正常"},{value:2,label:"草稿"},{value:3,label:"回收站"}],classOptions:[{}],searchClass:"",searchState:"",loading1:!1,articles:[],select:"",total:1,page:1,pageSize:25,searchInfo:""}},methods:{handleSelect:function(t){this.selectItem=t},batchDelete:function(t){var e=this;this.$confirm("此操作将永久删除这些文章, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http.post("/admin/allArticle/batchDelete",{keyArr:t}).then(function(t){t.body.result?(this.$message({title:"成功",message:"批量删除文章成功",type:"success"}),this.init()):this.$message.error({title:"失败",message:t.body.msg})}).catch(function(t){if(422==t.status){for(var e in t.body){var a=t.body[e];this.$message.error(a[0])}}else this.$message.error("错误：状态码"+t.status)})}).catch(function(){})},batchChange:function(){var t=[],e=!0,a=!1,s=void 0;try{for(var i,l=this.selectItem[Symbol.iterator]();!(e=(i=l.next()).done);e=!0){var n=i.value;t.push(n.id)}}catch(t){a=!0,s=t}finally{try{!e&&l.return&&l.return()}finally{if(a)throw s}}this.$http.post("/admin/allArticle/batchChange",{keyArr:t,state:this.batchChangeState}).then(function(t){t.body.result?(this.$message({title:"成功",message:"批量修改文章状态成功",type:"success"}),this.stateOptionsVisible=!1,this.init()):this.$message.error({title:"失败",message:t.body.msg})}).catch(function(t){if(422==t.status){for(var e in t.body){var a=t.body[e];this.$message.error(a[0])}}else this.$message.error("错误：状态码"+t.status)})},batch:function(){if(!this.action)return void this.$message.error("请选择操作");var t=[],e=!0,a=!1,s=void 0;try{for(var i,l=this.selectItem[Symbol.iterator]();!(e=(i=l.next()).done);e=!0){var n=i.value;t.push(n.id)}}catch(t){a=!0,s=t}finally{try{!e&&l.return&&l.return()}finally{if(a)throw s}}if(t.length<1)return void this.$message.error("当前没有选中项");1==this.action&&this.batchDelete(t),2==this.action&&(this.stateOptionsVisible=!0)},refresh:function(){Object.assign(this.$data,this.$options.data()),this.init()},init:function(){this.loading1=!0,this.$http.post("/allArticle",{page:this.page,pageSize:this.pageSize,searchInfo:this.searchInfo,searchClass:this.searchClass,searchState:this.searchState}).then(function(t){t.body.result?(this.classOptions=t.body.class,this.articles=t.body.articles,this.total=t.body.total,this.$message({title:"成功",message:"获取信息成功",type:"success"})):this.$message.error({title:"失败",message:t.body.msg}),this.loading1=!1}).catch(function(t){if(422==t.status){for(var e in t.body){var a=t.body[e];this.$message.error(a[0])}}else this.$message.error("错误：状态码"+t.status)})},handleEdit:function(t,e){this.editUserVisible=!0,this.editUser.account=e.account,this.editUser.name=e.name,this.editUser.state=e.state,this.editUser.role=e.role_id,this.editUser.id=e.id},handleBack:function(t,e){var a=this;this.$confirm("将该文章还原成草稿，您可以重新编辑并发布, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$http.post("/admin/allArticle/back",{articleId:e.id}).then(function(t){t.body.result?(this.$message({message:"还原成功",type:"success"}),this.init()):this.$message.error({title:"失败",message:t.body.msg})})}).catch(function(t){if(422==t.status){for(var e in t.body){var a=t.body[e];this.$message.error(a[0])}}else this.$message.error("错误：状态码"+t.status)})},handleToCycle:function(t,e){var a=this;this.$confirm("将该文章放入回收站，您可以恢复此操作, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$http.post("/admin/allArticle/recycleBin",{articleId:e.id}).then(function(t){t.body.result?(this.$message({message:"放入回收站成功",type:"success"}),this.init()):this.$message.error({title:"失败",message:t.body.msg})})})},handleUp:function(t,e){var a=this;if(!e.thumbnail)return void this.$message.error("该文章没有缩略图，无法置顶");this.$confirm("将该文章置顶, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$http.post("/admin/allArticle/up",{articleId:e.id}).then(function(t){t.body.result?(this.$message({message:"置顶成功",type:"success"}),this.init()):this.$message.error({title:"失败",message:t.body.msg})})})},handleDown:function(t,e){var a=this;this.$confirm("将该文章取消置顶, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$http.post("/admin/allArticle/down",{articleId:e.id}).then(function(t){t.body.result?(this.$message({message:"取消置顶成功",type:"success"}),this.init()):this.$message.error({title:"失败",message:t.body.msg})})})},handleDelete:function(t,e){var a=this;this.$confirm("此操作将永久删除该文章, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$http.post("/admin/allArticle/delete",{articleId:e.id}).then(function(t){t.body.result?(this.$message({message:"删除文章成功",type:"success"}),this.init()):this.$message.error({title:"失败",message:t.body.msg})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},handleSizeChange:function(t){this.pageSize=t},handleCurrentChange:function(t){this.page=t}},watch:{pageSize:"init",page:"init"}}},275:function(t,e,a){e=t.exports=a(7)(),e.push([t.i,".hand{cursor:pointer;margin-right:2px}.searchRow{margin-bottom:0}.grayRow{padding:7px;background:#f2f2f2;margin:10px 0}.demo-table-expand{font-size:0}.demo-table-expand label{width:90px;color:#99a9bf}.demo-table-expand .el-form-item{margin-right:0;margin-bottom:0;width:33%}",""])},531:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading1,expression:"loading1"}],attrs:{"element-loading-text":"加载中"}},[a("div",{staticClass:"grayRow"},[a("el-row",{staticClass:"searchRow"},[a("el-col",{attrs:{span:2}},[a("el-select",{attrs:{size:"small",placeholder:"按类别搜索"},model:{value:t.searchClass,callback:function(e){t.searchClass=e},expression:"searchClass"}},t._l(t.classOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.className,value:t.id}})}))],1),t._v(" "),a("el-col",{attrs:{span:2}},[a("el-select",{attrs:{size:"small",placeholder:"按状态搜索"},model:{value:t.searchState,callback:function(e){t.searchState=e},expression:"searchState"}},t._l(t.stateOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-col",{attrs:{span:3}},[a("el-input",{attrs:{placeholder:"搜索标题，作者",size:"small"},model:{value:t.searchInfo,callback:function(e){t.searchInfo=e},expression:"searchInfo"}})],1),t._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary",icon:"search"},on:{click:function(e){t.init()}}},[t._v("查询")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"small",icon:"loading"},on:{click:function(e){t.refresh()}}},[t._v("重置")])],1)],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.articles,stripe:""},on:{"selection-change":t.handleSelect}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{type:"index",label:"#",width:"55",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"title",label:"标题",width:"260",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"author",label:"作者",width:"150",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"className",label:"类别",width:"120",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"clickNum",label:"阅读量",width:"140 ",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"created_at",label:"创建时间",width:"180",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"updated_at",label:"最后编辑",width:"180",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"状态",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t._f("stateTag")(e.row.state)}},[t._v(t._s(t._f("stateToWord")(e.row.state)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.power.indexOf("editArticle")>0?a("a",{attrs:{href:"/admin#/addArticle?articleId="+e.row.id,title:"编辑"}},[a("i",{staticClass:"hand el-icon-edit",staticStyle:{color:"#00a0e9"}})]):t._e(),t._v(" "),a("a",{attrs:{href:"/article/"+e.row.id,target:"_blank",title:"查看文章"}},[a("i",{staticClass:"hand fa fa-file-text",staticStyle:{color:"black"}})]),t._v(" "),t.power.indexOf("upArticle")>0&&1==e.row.state?a("a",{attrs:{title:"置顶"}},[a("i",{staticClass:"hand fa fa-arrow-up",staticStyle:{color:"red"},on:{click:function(a){t.handleUp(e.$index,e.row)}}})]):t._e(),t._v(" "),t.power.indexOf("downArticle")>0&&0==e.row.state?a("a",{attrs:{title:"取消置顶"}},[a("i",{staticClass:"hand fa fa-arrow-down",staticStyle:{color:"red"},on:{click:function(a){t.handleDown(e.$index,e.row)}}})]):t._e(),t._v(" "),t.power.indexOf("deleteArticle")>0?a("a",{attrs:{title:"删除"}},[a("i",{staticClass:"hand el-icon-delete2",staticStyle:{color:"red"},on:{click:function(a){t.handleDelete(e.$index,e.row)}}})]):t._e(),t._v(" "),t.power.indexOf("backArticleFromBin")>0&&3==e.row.state?a("a",{attrs:{title:"从回收站中还原成草稿"}},[a("i",{staticClass:"hand fa fa-backward",staticStyle:{color:"#00ab00"},on:{click:function(a){t.handleBack(e.$index,e.row)}}})]):t._e(),t._v(" "),t.power.indexOf("addArticleToBin")>0&&3!=e.row.state?a("a",{attrs:{title:"加入回收站"}},[a("i",{staticClass:"hand el-icon-circle-close",staticStyle:{color:"orange"},on:{click:function(a){t.handleToCycle(e.$index,e.row)}}})]):t._e()]}}])})],1),t._v(" "),a("div",{staticClass:"grayRow"},[a("el-select",{attrs:{size:"small",placeholder:"选择批量操作"},model:{value:t.action,callback:function(e){t.action=e},expression:"action"}},t._l(t.actionOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),t._v(" "),a("el-button",{attrs:{type:"primary",size:"small",icon:"loading"},on:{click:function(e){t.batch()}}},[t._v("应用批量操作")]),t._v(" "),a("el-pagination",{staticStyle:{float:"right"},attrs:{"current-page":t.page,"page-sizes":[25,100,200,300,400],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),a("el-dialog",{attrs:{size:"tiny",title:"修改状态",visible:t.stateOptionsVisible},on:{"update:visible":function(e){t.stateOptionsVisible=e}}},[a("el-form",[a("el-row",[a("el-col",{attrs:{span:14}},[a("el-form-item",{attrs:{label:"文章状态","label-width":t.formLabelWidth}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:t.batchChangeState,callback:function(e){t.batchChangeState=e},expression:"batchChangeState"}},t._l(t.stateOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",slot:"footer"},[a("el-button",{on:{click:function(e){t.stateOptionsVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.batchChange()}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]}},543:function(t,e,a){var s=a(275);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a(28)("73d64194",s,!0)},95:function(t,e,a){a(543);var s=a(27)(a(257),a(531),null,null);t.exports=s.exports}});