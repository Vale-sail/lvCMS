webpackJsonp([5],{261:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:["power"],mounted:function(){this.init()},data:function(){return{selectItem:[],actionOptions:[{value:1,label:"批量删除"}],action:"",loading1:!1,newUrlButton:!1,friends:[],newUrlVisitable:!1,title:"",friend:{name:"",url:"",top:0},type:""}},methods:{batch:function(){if(!this.action)return void this.$message.error("请选择操作");var t=[],e=!0,i=!1,s=void 0;try{for(var n,r=this.selectItem[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var l=n.value;t.push(l.id)}}catch(t){i=!0,s=t}finally{try{!e&&r.return&&r.return()}finally{if(i)throw s}}if(t.length<1)return void this.$message.error("当前没有选中项");var a="";1==this.action&&(a="/admin/friends/batchDelete"),this.$http.post(a,{keyArr:t}).then(function(t){t.body.result?(this.$message({title:"成功",message:"批量删除链接成功",type:"success"}),this.init()):this.$message.error({title:"失败",message:t.body.msg})}).catch(function(t){if(422==t.status){for(var e in t.body){var i=t.body[e];this.$message.error(i[0])}}else this.$message.error("错误：状态码"+t.status)})},handleSelect:function(t){this.selectItem=t},refresh:function(){Object.assign(this.$data,this.$options.data()),this.init()},init:function(){this.loading1=!0,this.$http.post("/friends",{}).then(function(t){t.body.result?(this.friends=t.body.friends,this.$message({title:"成功",message:"获取信息成功",type:"success"})):this.$message.error({title:"失败",message:t.body.msg}),this.loading1=!1}).catch(function(t){if(422==t.status){for(var e in t.body){var i=t.body[e];this.$message.error(i[0])}}else this.$message.error("错误：状态码"+t.status);this.loading1=!1})},addOrEditUrl:function(t){return this.friend.name.trim().length<1?void this.$message.error("链接名不能为空"):this.friend.url.trim().length<1?void this.$message.error("链接地址不能为空"):(this.newUrlButton=!0,this.$message.info({title:"消息",message:"正在更新信息"}),void this.$http.post("/admin/friends/"+this.type,{friend:this.friend}).then(function(t){t.body.result?(this.$message({title:"成功",message:"更新信息",type:"success"}),this.newUrlVisitable=!1,this.init()):this.$message.error({title:"失败",message:t.body.msg}),this.newUrlButton=!1}).catch(function(t){if(422==t.status){for(var e in t.body){var i=t.body[e];this.$message.error(i[0])}}else this.$message.error("错误：状态码"+t.status);this.newUrlButton=!1}))},handleAdd:function(){this.type="add",this.newUrlVisitable=!0,this.title="新增链接",this.friend={name:"",url:"",top:0}},handleEdit:function(t,e){this.type="edit",this.newUrlVisitable=!0,this.title="编辑链接",this.friend={id:e.id,name:e.name,url:e.url,top:e.top}},handleDelete:function(t,e){var i=this;this.$confirm("永久删除该链接,是否继续","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.$http.post("/admin/friends/delete",{id:e.id}).then(function(t){t.body.result?(this.$message.success("删除成功"),this.init()):this.$message.error("删除失败:"+t.body.msg)}).catch(function(t){if(422==t.status){for(var e in t.body){var i=t.body[e];this.$message.error(i[0])}}else this.$message.error("错误：状态码"+t.status)})}).catch(function(){i.$message({type:"info",message:"已取消删除"})})}}}},277:function(t,e,i){e=t.exports=i(7)(),e.push([t.i,".grayRow{padding:10px;background:#f2f2f2;margin:10px 0}",""])},533:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading1,expression:"loading1"}],attrs:{"element-loading-text":"加载中"}},[i("div",{staticClass:"grayRow"},[t.power.indexOf("addFriend")>0?i("el-button",{attrs:{type:"primary",size:"small",icon:"plus"},on:{click:function(e){t.handleAdd()}}},[t._v("新增链接")]):t._e(),t._v(" "),i("el-button",{attrs:{type:"primary",size:"small",icon:"loading"},on:{click:function(e){t.refresh()}}},[t._v("刷新")])],1),t._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.friends,stripe:""},on:{"selection-change":t.handleSelect}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),i("el-table-column",{attrs:{type:"index",label:"#",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"name",label:"链接名",width:"250"}}),t._v(" "),i("el-table-column",{attrs:{prop:"url",label:"链接地址",width:"250"}}),t._v(" "),i("el-table-column",{attrs:{label:"状态",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-tag",{attrs:{type:1==e.row.top?"primary":"danger"}},[t._v(t._s(1==e.row.top?"置顶":"普通"))])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.power.indexOf("editFriend")>0?i("el-button",{attrs:{size:"small"},on:{click:function(i){t.handleEdit(e.$index,e.row)}}},[t._v("编辑")]):t._e(),t._v(" "),t.power.indexOf("deleteFriend")>0?i("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(i){t.handleDelete(e.$index,e.row)}}},[t._v("删除")]):t._e()]}}])})],1),t._v(" "),i("div",{staticClass:"grayRow"},[i("el-select",{attrs:{size:"small",placeholder:"选择批量操作"},model:{value:t.action,callback:function(e){t.action=e},expression:"action"}},t._l(t.actionOptions,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),t._v(" "),i("el-button",{attrs:{type:"primary",size:"small",icon:"loading"},on:{click:function(e){t.batch()}}},[t._v("应用批量操作")])],1),t._v(" "),i("el-dialog",{attrs:{size:"tiny",title:t.title,visible:t.newUrlVisitable},on:{"update:visible":function(e){t.newUrlVisitable=e}}},[i("el-form",{ref:"newRole",attrs:{model:t.friend}},[i("el-row",[i("el-col",{attrs:{span:22}},[i("el-form-item",{attrs:{label:"链接名","label-width":"120px"}},[i("el-input",{model:{value:t.friend.name,callback:function(e){t.friend.name=e},expression:"friend.name"}})],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{span:22}},[i("el-form-item",{attrs:{label:"链接地址","label-width":"120px"}},[i("el-input",{model:{value:t.friend.url,callback:function(e){t.friend.url=e},expression:"friend.url"}})],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{span:22}},[i("el-form-item",{attrs:{label:"置顶","label-width":"120px"}},[i("el-switch",{attrs:{"on-text":"是","off-text":"否","on-color":"#13ce66","off-color":"#ff4949","on-value":1,"off-value":0},model:{value:t.friend.top,callback:function(e){t.friend.top=e},expression:"friend.top"}})],1)],1)],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",slot:"footer"},[i("el-button",{on:{click:function(e){t.newUrlVisitable=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary",disabled:t.newUrlButton},on:{click:function(e){t.addOrEditUrl()}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]}},545:function(t,e,i){var s=i(277);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);i(28)("4cfdefb9",s,!0)},99:function(t,e,i){i(545);var s=i(27)(i(261),i(533),null,null);t.exports=s.exports}});