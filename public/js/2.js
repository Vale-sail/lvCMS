webpackJsonp([2],{102:function(e,t,s){s(539);var a=s(27)(s(264),s(527),null,null);e.exports=a.exports},264:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:["power"],mounted:function(){this.init()},filters:{stateToWord:function(e){return 0==e?"正常":1==e?"禁止登录":2==e?"禁止发言":3==e?"等待验证":void 0}},data:function(){return{batchChangeState:"",stateOptionsVisible:!1,selectItem:[],action:"",actionOptions:[{value:1,label:"批量删除"},{value:2,label:"批量修改状态"}],searchRole:"",searchState:"",loading1:!1,select:"",input5:"",users:[],total:1,page:1,pageSize:25,searchInfo:"",formLabelWidth:"120px",editUserRules:{account:[{required:!0,message:"请输入角色账号",trigger:"blur"},{min:6,max:30,message:"长度在 6到 30 个字符",trigger:"blur"}],password:[{required:!1,message:"请输入角色密码",trigger:"blur"},{min:6,max:18,message:"长度在 6到 18 个字符",trigger:"blur"}],name:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}],state:[{required:!0,type:"number",message:"请选择用户状态"}]},editUserVisible:!1,editUser:{id:"",account:"",name:"",password:"",state:"",role:""},editUserConfirm:!1,roleOptions:[],stateOptions:[{value:0,label:"正常"},{value:1,label:"禁止登录"},{value:2,label:"禁止发言"},{value:3,label:"等待验证"}]}},methods:{handleSelect:function(e){this.selectItem=e},refresh:function(){Object.assign(this.$data,this.$options.data()),this.init()},init:function(){this.loading1=!0,this.$http.post("/allUser",{page:this.page,pageSize:this.pageSize,searchInfo:this.searchInfo,searchRole:this.searchRole,searchState:this.searchState}).then(function(e){e.body.result?(this.users=e.body.users.users,this.total=e.body.users.total,this.roleOptions=e.body.roleOptions,this.$message({title:"成功",message:"获取信息成功",type:"success"})):this.$message.error({title:"失败",message:e.body.msg}),this.loading1=!1}).catch(function(e){if(422==e.status){for(var t in e.body){var s=e.body[t];this.$message.error(s[0])}}else this.$message.error("错误：状态码"+e.status);this.loading1=!1})},handleEdit:function(e,t){this.editUserVisible=!0,this.editUser.account=t.account,this.editUser.name=t.name,this.editUser.state=t.state,this.editUser.role=t.role_id,this.editUser.id=t.id},handleDelete:function(e,t){var s=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.$message.info("正在提交信息"),s.$http.post("/admin/allUser/deleteUser",{id:t.id}).then(function(e){e.body.result?(this.$message({message:"删除用户成功",type:"success"}),this.editUserConfirm=!1,this.init()):this.$message.error({title:"失败",message:e.body.msg})}).catch(function(e){if(422==e.status){for(var t in e.body){var s=e.body[t];this.$message.error(s[0])}}else this.$message.error("错误：状态码"+e.status)})}).catch(function(){s.$message({type:"info",message:"已取消删除"})})},editUserButton:function(e){var t=this;this.$refs[e].validate(function(e){e&&(t.editUserConfirm=!0,t.$message.info("正在提交信息"),t.$http.post("/admin/allUser/editUser",{id:t.editUser.id,editUser:t.editUser}).then(function(e){e.body.result?(this.$message({title:"成功",message:"编辑用户成功",type:"success"}),this.init()):this.$message.error({title:"失败",message:e.body.msg}),this.editUserConfirm=!1,this.editUserVisible=!1}).catch(function(e){if(422==e.status){for(var t in e.body){var s=e.body[t];this.$message.error(s[0])}}else this.$message.error("错误：状态码"+e.status);this.editUserConfirm=!1,this.editUserVisible=!1}))})},handleSizeChange:function(e){this.pageSize=e},handleCurrentChange:function(e){this.page=e},batchChange:function(){var e=[],t=!0,s=!1,a=void 0;try{for(var i,l=this.selectItem[Symbol.iterator]();!(t=(i=l.next()).done);t=!0){var r=i.value;e.push(r.id)}}catch(e){s=!0,a=e}finally{try{!t&&l.return&&l.return()}finally{if(s)throw a}}this.editUserConfirm=!0,this.$http.post("/admin/allUser/batchChange",{keyArr:e,state:this.batchChangeState}).then(function(e){e.body.result?(this.$message({title:"成功",message:"批量修改用户状态成功",type:"success"}),this.init()):this.$message.error({title:"失败",message:e.body.msg}),this.editUserConfirm=!1,this.stateOptionsVisible=!1}).catch(function(e){if(422==e.status){for(var t in e.body){var s=e.body[t];this.$message.error(s[0])}}else this.$message.error("错误：状态码"+e.status);this.editUserConfirm=!1})},batch:function(){if(!this.action)return void this.$message.error("请选择操作");var e=[],t=!0,s=!1,a=void 0;try{for(var i,l=this.selectItem[Symbol.iterator]();!(t=(i=l.next()).done);t=!0){var r=i.value;e.push(r.id)}}catch(e){s=!0,a=e}finally{try{!t&&l.return&&l.return()}finally{if(s)throw a}}if(e.length<1)return void this.$message.error("当前没有选中项");var o="";if(1==this.action)o="/admin/allUser/batchDelete";else if(2==this.action)return void(this.stateOptionsVisible=!0);this.$http.post(o,{keyArr:e}).then(function(e){e.body.result?(this.$message({title:"成功",message:"批量删除用户成功",type:"success"}),this.init()):this.$message.error({title:"失败",message:e.body.msg})}).catch(function(e){if(422==e.status){for(var t in e.body){var s=e.body[t];this.$message.error(s[0])}}else this.$message.error("错误：状态码"+e.status)})}},watch:{pageSize:"init",page:"init"}}},271:function(e,t,s){t=e.exports=s(7)(),t.push([e.i,".searchRow{margin-bottom:0}.grayRow{padding:7px;background:#f2f2f2;margin:10px 0}.demo-table-expand{font-size:0}.demo-table-expand label{width:90px;color:#99a9bf}.demo-table-expand .el-form-item{margin-right:0;margin-bottom:0;width:33%}",""])},527:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading1,expression:"loading1"}],attrs:{"element-loading-text":"加载中"}},[s("div",{staticClass:"grayRow"},[s("el-row",{staticClass:"searchRow"},[s("el-col",{attrs:{span:2}},[s("el-select",{attrs:{size:"small",placeholder:"按身份搜索"},model:{value:e.searchRole,callback:function(t){e.searchRole=t},expression:"searchRole"}},e._l(e.roleOptions,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),s("el-col",{attrs:{span:2}},[s("el-select",{attrs:{size:"small",placeholder:"按状态搜索"},model:{value:e.searchState,callback:function(t){e.searchState=t},expression:"searchState"}},e._l(e.stateOptions,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),s("el-col",{attrs:{span:3}},[s("el-input",{attrs:{placeholder:"搜索账户，名称",size:"small"},model:{value:e.searchInfo,callback:function(t){e.searchInfo=t},expression:"searchInfo"}})],1),e._v(" "),s("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"primary",icon:"search"},on:{click:function(t){e.init()}}},[e._v("查询")]),e._v(" "),s("el-button",{attrs:{type:"primary",size:"small",icon:"loading"},on:{click:function(t){e.refresh()}}},[e._v("重置")])],1)],1),e._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.users,stripe:""},on:{"selection-change":e.handleSelect}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),s("el-table-column",{attrs:{type:"index",label:"#",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"account",label:"账号",width:"180",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"name",label:"姓名",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"role",label:"角色",width:"180",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"created_at",label:"注册时间",width:"180",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"register_address",label:"注册地址"}}),e._v(" "),s("el-table-column",{attrs:{label:"状态",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n           "+e._s(e._f("stateToWord")(t.row.state))+"\n        ")]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.power.indexOf("editUser")>0?s("el-button",{attrs:{size:"small"},on:{click:function(s){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),e.power.indexOf("deleteUser")>0?s("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(s){e.handleDelete(t.$index,t.row)}}},[e._v("删除")]):e._e()]}}])})],1),e._v(" "),s("div",{staticClass:"grayRow"},[s("el-select",{attrs:{size:"small",placeholder:"选择批量操作"},model:{value:e.action,callback:function(t){e.action=t},expression:"action"}},e._l(e.actionOptions,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),s("el-button",{attrs:{type:"primary",size:"small",icon:"loading"},on:{click:function(t){e.batch()}}},[e._v("应用批量操作")]),e._v(" "),s("el-pagination",{staticStyle:{float:"right"},attrs:{"current-page":e.page,"page-sizes":[25,100,200,300,400],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),s("el-dialog",{attrs:{title:"编辑用户",visible:e.editUserVisible},on:{"update:visible":function(t){e.editUserVisible=t}}},[s("el-form",{ref:"editUserRules",attrs:{model:e.editUser,rules:e.editUserRules}},[s("el-row",[s("el-col",{attrs:{span:14}},[s("el-form-item",{attrs:{label:"用户账号","label-width":e.formLabelWidth,prop:"account"}},[s("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editUser.account,callback:function(t){e.editUser.account=t},expression:"editUser.account"}})],1)],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:14}},[s("el-form-item",{attrs:{label:"用户密码","label-width":e.formLabelWidth,prop:"password"}},[s("el-input",{attrs:{placeholder:"可留空不做修改","auto-complete":"off"},model:{value:e.editUser.password,callback:function(t){e.editUser.password=t},expression:"editUser.password"}})],1)],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:14}},[s("el-form-item",{attrs:{label:"用户昵称","label-width":e.formLabelWidth,prop:"name"}},[s("el-input",{attrs:{"auto-complete":"off"},model:{value:e.editUser.name,callback:function(t){e.editUser.name=t},expression:"editUser.name"}})],1)],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:14}},[s("el-form-item",{attrs:{label:"用户角色",prop:"role","label-width":e.formLabelWidth}},[s("el-select",{staticStyle:{width:"100%"},model:{value:e.editUser.role,callback:function(t){e.editUser.role=t},expression:"editUser.role"}},e._l(e.roleOptions,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id,disabled:e.disable}})}))],1)],1)],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:14}},[s("el-form-item",{attrs:{label:"用户状态",prop:"state","label-width":e.formLabelWidth}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.editUser.state,callback:function(t){e.editUser.state=t},expression:"editUser.state"}},e._l(e.stateOptions,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",slot:"footer"},[s("el-button",{on:{click:function(t){e.editUserVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.editUserConfirm},on:{click:function(t){e.editUserButton("editUserRules")}}},[e._v("确 定")])],1)],1),e._v(" "),s("el-dialog",{attrs:{size:"tiny",title:"修改状态",visible:e.stateOptionsVisible},on:{"update:visible":function(t){e.stateOptionsVisible=t}}},[s("el-form",{ref:"editUserRules",attrs:{model:e.editUser}},[s("el-row",[s("el-col",{attrs:{span:14}},[s("el-form-item",{attrs:{label:"用户状态","label-width":e.formLabelWidth}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.batchChangeState,callback:function(t){e.batchChangeState=t},expression:"batchChangeState"}},e._l(e.stateOptions,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",slot:"footer"},[s("el-button",{on:{click:function(t){e.stateOptionsVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary",disabled:e.editUserConfirm},on:{click:function(t){e.batchChange()}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]}},539:function(e,t,s){var a=s(271);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);s(28)("d7be829c",a,!0)}});